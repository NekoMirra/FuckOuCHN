# 功能开关说明

## 📋 概述

本系统支持细粒度的功能控制，您可以选择性地开启或关闭特定类型的课程活动处理。

## 🎛️ 功能开关配置

在 `.env` 文件中配置以下开关（1=开启，0=关闭）：

### 视频类活动
```bash
_ENABLE_VIDEO=1  # 控制所有视频类活动
```
包含的活动类型：
- `online_video` - 在线视频
- `lesson` - 录播教材
- `lesson_replay` - 教室录播
- `slide` - 微课

### 测试类活动

```bash
_ENABLE_EXAM=0          # 考试答题
_ENABLE_CLASSROOM=1     # 随堂测试
```

### 其他活动

```bash
_ENABLE_PAGE=1              # 页面浏览
_ENABLE_MATERIAL=1          # 参考资料（PDF等）
_ENABLE_FORUM=1             # 讨论论坛
_ENABLE_WEBLINK=1           # 线上链接
_ENABLE_HOMEWORK=1          # 作业提交
_ENABLE_TENCENT_MEETING=1   # 腾讯会议/课堂直播
```

## 💡 使用场景示例

### 场景1：只刷视频
```bash
_ENABLE_VIDEO=1
_ENABLE_EXAM=0
_ENABLE_CLASSROOM=0
_ENABLE_PAGE=0
_ENABLE_MATERIAL=0
_ENABLE_FORUM=0
_ENABLE_WEBLINK=0
_ENABLE_HOMEWORK=0
_ENABLE_TENCENT_MEETING=0
```

### 场景2：只刷讨论和资料
```bash
_ENABLE_VIDEO=0
_ENABLE_EXAM=0
_ENABLE_CLASSROOM=0
_ENABLE_PAGE=0
_ENABLE_MATERIAL=1
_ENABLE_FORUM=1
_ENABLE_WEBLINK=0
_ENABLE_HOMEWORK=0
_ENABLE_TENCENT_MEETING=0
```

### 场景3：刷所有内容（默认）
```bash
_ENABLE_VIDEO=1
_ENABLE_EXAM=1
_ENABLE_CLASSROOM=1
_ENABLE_PAGE=1
_ENABLE_MATERIAL=1
_ENABLE_FORUM=1
_ENABLE_WEBLINK=1
_ENABLE_HOMEWORK=1
_ENABLE_TENCENT_MEETING=1
```

### 场景4：只做测试（考试+随堂）
```bash
_ENABLE_VIDEO=0
_ENABLE_EXAM=1
_ENABLE_CLASSROOM=1
_ENABLE_PAGE=0
_ENABLE_MATERIAL=0
_ENABLE_FORUM=0
_ENABLE_WEBLINK=0
_ENABLE_HOMEWORK=0
_ENABLE_TENCENT_MEETING=0
```

## 🛠️ 注意事项

1. **不设置或留空**：使用默认值（大部分默认开启）
2. **启动时显示**：程序启动时会显示当前开关状态
3. **动态生效**：修改 `.env` 后重启程序即可生效
4. **独立控制**：每个活动类型都可以独立开关，互不影响

## 🔧 弹窗处理改进

### 问题
在处理参考资料（PDF等）时，如果弹窗无法关闭，会导致程序卡住。

### 解决方案
新增了弹窗强制关闭机制：
1. 尝试正常关闭弹窗
2. 如果失败，强制点击关闭按钮
3. 如果仍失败，按ESC键
4. 如果弹窗还在，**自动重载页面**并跳出循环

### 日志提示
```
⚠️ PDF 1 处理失败，尝试关闭弹窗继续
🔄 弹窗无法关闭，强制重载页面...
```

## 📊 功能状态查看

程序启动时会显示所有功能开关状态：

```
========== 功能开关 ==========
📹 视频刷课 (online_video/lesson/lesson_replay/slide): ✅ 开启
📝 考试答题 (exam): ❌ 关闭
📝 随堂测试 (classroom): ✅ 开启
📄 页面浏览 (page): ✅ 开启
📚 参考资料 (material): ✅ 开启
💬 讨论论坛 (forum): ✅ 开启
🔗 线上链接 (web_link): ✅ 开启
📋 作业提交 (homework): ✅ 开启
🎥 腾讯会议 (tencent_meeting): ✅ 开启
================================
```

## 🔄 版本历史

### v2.0 - 细粒度控制
- ✅ 支持9种活动类型的独立开关
- ✅ 弹窗强制重载机制
- ✅ 改进的功能状态显示

### v1.0 - 基础版本
- 仅支持视频和考试两个总开关
